<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
    <title>Live Voting App</title>
</head>
<body>
    <h1>Which one do you prefer</h1>
    <button id="optionA">Option A</button>
    <button id="optionB">Option B</button>

    <div id="results">
        <h2>Results:</h2>
        <p>Option A: <span id="optionAResult">0</span> votes</p>
        <p>Option B: <span id="optionBResult">0</span> votes</p>
    </div>

    <script>
        const socket = io();

        document.getElementById('optionA').addEventListener('click', () => {
            socket.emit('vote', 'optionA');
        });

        document.getElementById('optionB').addEventListener('click', () => {
            socket.emit('vote', 'optionB');
        });

        socket.on('voteUpdate', (option) => {
            if (option == 'optionA') {
                document.getElementById('optionAResult').textContent++;
            } else if (option == 'optionB') {
                document.getElementById('optionBResult').textContent++;
            }
        });

        socket.on('loadHistory', (votes) => {
            votes.forEach(entry => {
                if (entry.option === 'optionA') {
                    document.getElementById('optionAResult').textContent = entry.count;
                } else if (entry.option === 'optionB') {
                    document.getElementById('optionBResult').textContent = entry.count;
                }
            });
        });
    </script>
</body>
</html>
